{% extends "base.html" %}

{% load static %}

{% csrf_token %}

{% block content %}
<div class="card mb-4">
    <div class="card-body d-flex flex-column align-items-start">
        <h1 class="h5 mb-0">Receita: {{data.product.name}}</h1>
    </div>
</div>

<input type="hidden" name="id" value="{{ data.recipe.id }}">
<input type="hidden" name="product" value="{{ data.recipe.product.id }}">

<div class="d-flex align-items-end gap-3 flex-wrap">
    <div class="mb-3">
        <label for="edit-entity-yields" class="form-label">Rendimento (porções)</label>
        <input type="number" class="form-control" id="edit-entity-yields" name="yields" min="0" step="0.01"
            value="{{ data.recipe.yields }}" disabled>
    </div>

    <div class="mb-3">
        <label for="edit-entity-preptime" class="form-label">Tempo de Preparo (minutos)</label>
        <input type="number" class="form-control" id="edit-entity-preptime" name="preparationTimeInMinutes" min="0"
            step="1" value="{{ data.recipe.preparationTimeInMinutes }}" disabled>
    </div>

    <div class="mb-3">
        <button type="button" class="btn btn-outline-info btn-entity-edit" data-id="{{data.entity.id}}"
            data-product="{{data.entity.product.id}}" data-yields="{{data.entity.yields}}"
            data-preptime="{{data.entity.preptime}}">
            Alterar
        </button>
    </div>

    <div class="mb-3">
        <button type="button" class="btn btn-primary" id="addIngredient">Adicionar ingredientes</button>
    </div>
</div>

<div class="alert alert-danger d-none" id="error-general"></div>

<div class="card">
    <div class="table-responsive">
        <table id="entities-table" class="table align-middle mb-0">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Nome</th>
                    <th>Último custo</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% if data.entities %}
                {% for entity in data.entities %}
                <tr data-id="{{entity.id}}">
                    <td class="text-muted">{{entity.id}}</td>
                    <td>{{entity.name}}</td>
                    <td>{{entity.lastCost}}</td>
                    <td>
                        <button type="button" class="btn btn-sm btn-outline-info btn-ingredient-edit"
                            data-id="{{entity.id}}" data-name="{{entity.name}}">
                            Alterar
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-danger btn-ingredient-delete"
                            data-id="{{entity.id}}">
                            Remover
                        </button>
                    </td>
                </tr>
                {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

{% include "modals/recipe/edit.html"%}

{% block modal_scritps %}
<script src="{% static 'js/modals/recipe/edit.js' %}"></script>
{% endblock %}

{% endblock %}